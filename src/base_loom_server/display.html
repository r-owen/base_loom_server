<!DOCTYPE html>
<html>

<head>
    <style>
        {display_css}
    </style>
    <title>Loom server</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
</head>

<body>
    <div class="flex-row" id="mode">
        <div class="tabbar">
            <button class="tabchoices" id="mode_weaving">{Weaving}</button>
            <button class="tabchoices" id="mode_threading">{Threading}</button>
            <button class="tabchoices" id="mode_settings">{Settings}</button>
        </div>
    </div>

    <div class="flex-column settings-flex" id="setting-loom-name-form">
        <form class="settings-flex">
            <label>{Loom name}</label>
            <input type="text" id="setting-loom-name-input"></input>
            <button type="submit" id="setting-loom-name-submit">{Save}</button>
            <button type="button" id="setting-loom-name-reset">{Reset}</button>
        </form>
        <div class="flex-row" id="setting-direction-control-div">
            <label>{Direction control}</label>
            <select name="setting-direction-control" id="setting-direction-control">
                <option value="2">{Loom}</option>
                <option value="3">{Software}</option>
            </select>
        </div>
        <div class="flex-row">
            <label>{Thread}</label>
            <select name="setting-thread-right-to-left" id="setting-thread-right-to-left">
                <option value="1">{Right to left}</option>
                <option value="0">{Left to right}</option>
            </select>
            <select name="setting-thread-back-to-front" id="setting-thread-back-to-front">
                <option value="1">{Back to front}</option>
                <option value="0">{Front to back}</option>
            </select>
        </div>
        <div class="flex-row">
            <label>{Default threading group size}</label>
            <select name="setting-thread-group-size" id="setting-thread-group-size">
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
                <option>6</option>
                <option>7</option>
                <option>8</option>
                <option>9</option>
                <option>10</option>
            </select>
        </div>
    </div>

    <div class="flex-row not-settings-flex">
        <label>{Pattern}</label>
        <select name="pattern_menu" id="pattern_menu">
            <option></option>
            <hr>
            <option>{Clear Recents}</option>
        </select>
        <form class="upload-form">
            <input type="file" id="file_input" multiple accept=".dtx,.wif,.wpo" style="display:none;">
            <input type="button" value="{Upload}"  id="upload_patterns" onclick="document.getElementById('file_input').click()"/>
        </form>
    </div>

    <div class="canvas-grid weaving-grid">
        <div id="pattern_canvas_container">
            <div>
                <canvas id="pattern_canvas"></canvas>
            </div>
        </div>
    </div>

    <div class="canvas-grid threading-grid" style="display: none;">
        <div id="threading_canvas_container">
            <div>
                <canvas id="threading_canvas"></canvas>
            </div>
        </div>
    </div>

    <div class="flex-row not-settings-flex">
        <label>{Raised shafts}</label>
        <label id="shaft_state"></label>
    </div>

    <div class="flex-row weaving-flex">
        <label>{Direction}</label>
        <button type="button" id="weave_direction" class="toggle_button">?</button>        
    </div>

    <div class="flex-row threading-flex">
        <label>{Direction}</label>
        <button type="button" id="thread_direction" class="toggle_button">?</button>
        <div>
            <label id="group_size_label">{Group size}</label>
            <select name="thread_group_size" id="thread_group_size">
                <option>1</option>
                <option>2</option>
                <option>3</option>
                <option>4</option>
                <option>5</option>
                <option>6</option>
                <option>7</option>
                <option>8</option>
                <option>9</option>
                <option>10</option>
            </select>
        </div>
    </div>

    <div class="flex-row threading-flex" id="end_number_div" style="display: none;">
        <label id="end_label">{Ends}</label>
        <label id="total_end_number0"></label>
        <label> - </label>
        <label id="total_end_number1"></label>
        <label id="end_number0"></label>
        <label> - </label>
        <label id="end_number1"></label>
        <label>{of}</label>
        <label id="ends_per_repeat">?</label>
        <label>{repeat}</label>
        <label id="end_repeat_number"></label>
    </div>

    <div class="flex-row weaving-flex" id="pick_number_div">
        <label>{Pick}</label>
        <label id="total_picks"></label>
        <label id="pick_number"></label>
        <label>{of}</label>
        <label id="picks_per_repeat">?</label>
        <label>{repeat}</label>
        <label id="pick_repeat_number"></label>
        <canvas id="pick_color"></canvas>
    </div>

    <form action="" class="threading-flex" id="jump_to_end_form" style="display: none;">
        <div class="flex-row">
            <label>{Jump to end}</label>
            <input size="5" id="jump_total_end_number0" inpumode="decimal"></input>
            <button type="submit" id="jump_to_end_submit">{Jump}</button>
            <button type="button" id="jump_to_end_reset">{Reset}</button>
        </div>
    </form>

    <form action="" class="weaving-flex" id="jump_to_pick_form">
        <div class="flex-row">
            <label>{Jump to pick}</label>
            <input size="5" id="jump_total_pick_number" inpumode="decimal"></input>
            <button type="submit" id="jump_to_pick_submit">{Jump}</button>
            <button type="button" id="jump_to_pick_reset">{Reset}</button>
        </div>
    </form>

    <div class="flex-row threading-flex" id="separate_threading_repeats_grid" style="display: none">
        <label>{Separate repeats}?</label>
        <input type="checkbox" id="separate_threading_repeats" value="1"></input>
    </div>

    <div class="flex-row weaving-flex" id="separate_weaving_repeats_grid">
        <label>{Separate repeats}?</label>
        <input type="checkbox" id="separate_weaving_repeats"></input>
    </div>

    <div class="flex-row">
        <label id="loom_info"></label>
        <label id="status">disconnected</label>
    </div>

    <div class="flex-row">
        <label id="command_problem"/>
    </div>

    <div style="display:{display_debug_controls}" id="debug_div">
    <hr>
    <divclass="flex-row">Debug (mock loom)</div>
    
    <div class="flex-row">
        <label>{Command mock loom}</label>
        <button id="oob_next_pick">{Next Pick}</button>
        <button id="oob_change_direction">{Change Direction}</button>
        <button id="oob_close_connection">{Close Connection}</button>
    </div>

    <div class="flex-row">
        <label>{Sent command}: </label>
        <label id='sent_command'/>
    </div>

    <div class="flex-row">
        <label>{Read message}: </label>
        <label id='read_message'/>
    </div>

    <script>
        {display_js}
    </script>
</body>

</html>
