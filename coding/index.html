<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>Coding - Base Loom Server</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../css/mkapi-common.css" rel="stylesheet" />
        <link href="../css/mkapi-material.css" rel="stylesheet" />
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Coding";
        var mkdocs_page_input_path = "coding.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
 <link href="../assets/stylesheets/glightbox.min.css" rel="stylesheet"/><style>
    html.glightbox-open { overflow: initial; height: 100%; }
    .gslide-title { margin-top: 0px; user-select: text; }
    .gslide-desc { color: #666; user-select: text; }
    .gslide-image img { background: white; }</style> <script src="../assets/javascripts/glightbox.min.js"></script></head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> Base Loom Server
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../weaving/">Weaving</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../threading/">Threading</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../settings/">Settings</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../installing/">Installing</a>
                </li>
              </ul>
              <ul class="current">
                <li class="toctree-l1 current"><a class="reference internal current" href="#">Coding</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#installing-source-code">Installing Source Code</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#writing-a-loom-server">Writing a Loom Server</a>
    </li>
    </ul>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../translations/">Translations</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../version_history/">Version History</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">API Reference</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" >base_loom_server</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/">base_loom_server</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/app_runner/">base_loom_server.app_runner</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/base_loom_server/">base_loom_server.base_loom_server</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/base_mock_loom/">base_loom_server.base_mock_loom</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/check_translation_files/">base_loom_server.check_translation_files</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/client_replies/">base_loom_server.client_replies</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/constants/">base_loom_server.constants</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/enums/">base_loom_server.enums</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/example_loom_server/">base_loom_server.example_loom_server</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/example_mock_loom/">base_loom_server.example_mock_loom</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/main/">base_loom_server.main</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/mock_streams/">base_loom_server.mock_streams</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/pattern_database/">base_loom_server.pattern_database</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/reduced_pattern/">base_loom_server.reduced_pattern</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/rename_crowdin_files/">base_loom_server.rename_crowdin_files</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/testutils/">base_loom_server.testutils</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/translations/">base_loom_server.translations</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/utils/">base_loom_server.utils</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../api/base_loom_server/version/">base_loom_server.version</a>
                </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">Base Loom Server</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
      <li class="breadcrumb-item active">Coding</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="coding">Coding</h1>
<h2 id="installing-source-code">Installing Source Code</h2>
<ul>
<li>
<p>Install Python as explained in <a href="../installing/">Installing</a>.</p>
</li>
<li>
<p>Download the source code from <a href="https://github.com/r-owen/base_loom_server.git">github</a>,
  or make a fork and git clone that.</p>
</li>
<li>
<p>Inside the directory, do the following:</p>
<ul>
<li>Make "editable installation" of the package.
  An editable installation runs from the source code,
  so changes you make to the source are used when you run or test the code,
  without the need to reinstall the package:<pre><code>pip install -e .'[dev]'
</code></pre>
</li>
</ul>
<p>where the single quotes around <code>[dev]</code> are required in zsh, but not in bash.
  <code>'[dev]'</code> installs development-related packages such as pytest
  (see the file <code>pyproject.toml</code> for the full list).</p>
<ul>
<li>
<p>Activate the pre-commit hooks:</p>
<pre><code>pre-commit install
</code></pre>
</li>
<li>
<p>Run unit tests to test your installation:</p>
<pre><code>pytest
</code></pre>
</li>
</ul>
</li>
<li>
<p>You may run an example loom server with:</p>
<pre><code>run_example_loom &lt;num_shafts&gt; mock
</code></pre>
</li>
</ul>
<p>Please only specify the <strong>mock</strong> port; connecting the example loom server to a real loom will not work.</p>
<p>These run commands accept various <a href="../installing/#command-line-options">command-line options</a>, which you can see by running  with <code>-h</code> or <code>--help</code>. Two of note for debugging are:</p>
<pre><code>* `--reset-db` Reset the pattern database. Try this if you think the database is corrupted.

* `--verbose` Print more diagnostic information.
</code></pre>
<p>Note that the example loom server uses the same pattern database as
  <a href="https://pypi.org/project/seguin-loom-server/">seguin_loom_server</a>
  and <a href="https://pypi.org/project/toika-loom-server/">toika_loom_server</a>.</p>
<p>Also note that real loom servers can also run in mock mode. For example:</p>
<pre><code>    run_toika_loom 32 mock

    run_seguin_loom 16 mock
</code></pre>
<ul>
<li>
<p>In mock mode the web page shows a few extra controls for debugging.</p>
</li>
<li>
<p>Warning: the web server's automatic reload feature, which reloads Python code whenever you save changes,
  <em>does not work</em> with this software.
  Instead you have to kill the web server by typing control-C several times, until you get a terminal prompt, then run the server again.
  This may be a bug in uvicorn; see <a href="https://github.com/encode/uvicorn/discussions/2075">this discussion</a> for more information.</p>
</li>
</ul>
<h2 id="writing-a-loom-server">Writing a Loom Server</h2>
<ul>
<li>
<p>Install the <code>base_loom_server</code> package either using pip, or from source (as described above).
  Source makes it easier to look through the code.</p>
</li>
<li>
<p>Write a subclass of <code>BaseMockLoom</code> that emulates your loom.
  Two examples are <code>ExampleMockLoom</code> in this package and <code>MockLoom</code>
  in <a href="https://pypi.org/project/toika-loom-server/">toika_loom_server</a>.</p>
</li>
</ul>
<p>For simplicity and future compatibility, try to avoid overriding the constructor.
  Instead, perform loom-specific initialization by overriding the <code>__post_init__</code> method
  (which is normally a no-op in <code>BaseMockLoom</code>, so you need not call <code>super().__post_init__</code>).</p>
<ul>
<li>Write a subclass of <code>BaseLoomServer</code> that talks to the loom.
  Two examples are <code>ExampleLoomServer</code> in this package and <code>LoomServer</code>
  in <a href="https://pypi.org/project/toika-loom-server/">toika_loom_server</a>.</li>
</ul>
<p>For simplicity and future compatibility, try to avoid overriding the constructor.
  Instead, perform loom-specific initialization by overriding the <code>__post_init__</code> method
  (which is a no-op in <code>BaseLoomServer</code>, so you need not call <code>super().__post_init__</code>).</p>
<ul>
<li>
<p>Write a <code>main.py</code> like the one in <code>base_loom_server</code>, to run your loom server.</p>
</li>
<li>
<p>Copy <code>tests/test_mock_loom.py</code> and modify it to suit your mock loom.</p>
</li>
<li>
<p>The unit tests for your loom server should be able to use <code>testutils.BaseTestLoomServer</code>, as <code>tests/test_loom_server.py</code> does.</p>
</li>
<li>
<p>Write a <code>pyproject.toml</code> like the one for <a href="https://pypi.org/project/toika-loom-server/">toika_loom_server</a>.</p>
</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../installing/" class="btn btn-neutral float-left" title="Installing"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../translations/" class="btn btn-neutral float-right" title="Translations">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../installing/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../translations/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../javascript/mkapi.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

<script id="init-glightbox">const lightbox = GLightbox({"touchNavigation": true, "loop": false, "zoomable": true, "draggable": true, "openEffect": "zoom", "closeEffect": "zoom", "slideEffect": "slide"});
</script></body>
</html>
